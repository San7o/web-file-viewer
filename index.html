<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Draggable Split File Viewer</title>
<style>
  html, body {
    margin: 0;
    height: 100%;
    overflow: hidden;
    font-family: monospace;
  }

  .container {
    display: flex;
    height: 100%;
    width: 100%;
  }

  .left, .right {
    height: 100%;
    overflow-y: auto;
    padding: 1em;
  }

  .left {
    background: #f0f0f0;
    width: 50%; /* initial width */
    box-sizing: border-box;
  }

  .divider {
    width: 5px;
    cursor: col-resize;
    background: #ccc;
    transition: background 0.2s;
  }

  .divider:hover {
    background: #999;
  }

  .right {
    background: #fff;
    flex-grow: 1;
    border-left: 1px solid #aaa;
    white-space: pre-wrap;
    box-sizing: border-box;
  }

  #fileInput {
    margin-top: 1em;
  }

  /* Smooth resizing */
  .left, .right {
    transition: width 0.1s ease;
  }
</style>
</head>
<body>

<div class="container">
  <div class="left" id="left-panel">
    <h2>File Viewer Controls</h2>
    <p>Select a file to display on the right panel.</p>
    <input type="file" id="fileInput" accept=".txt,.log,.md,.json,.js,.py,.html,.css">
    <p style="font-size: 0.9em; color: #555;">You can drag the divider to resize panels.  
    The divider position will be remembered next time you reload the page.</p>
  </div>

  <div class="divider" id="divider"></div>

  <div class="right" id="file-view">
    <p style="color: #777;">No file loaded yet.</p>
  </div>
</div>

<script>
  const divider = document.getElementById('divider');
  const left = document.getElementById('left-panel');
  const right = document.getElementById('file-view');

  // --- Load saved width from localStorage ---
  const savedWidth = localStorage.getItem('leftPanelWidth');
  if (savedWidth) left.style.width = savedWidth;

  // --- Handle dragging ---
  let isDragging = false;

  divider.addEventListener('mousedown', (e) => {
    isDragging = true;
    document.body.style.cursor = 'col-resize';
    e.preventDefault();
  });

  document.addEventListener('mousemove', (e) => {
    if (!isDragging) return;
    const container = divider.parentNode;
    const containerRect = container.getBoundingClientRect();
    const pointerX = e.clientX - containerRect.left;
    const containerWidth = containerRect.width;

    const minWidth = 100;
    const maxWidth = containerWidth - 100;

    if (pointerX > minWidth && pointerX < maxWidth) {
      const percent = (pointerX / containerWidth) * 100;
      left.style.width = `${percent}%`;
    }
  });

  document.addEventListener('mouseup', () => {
    if (isDragging) {
      isDragging = false;
      document.body.style.cursor = 'default';
      // Save divider position
      localStorage.setItem('leftPanelWidth', left.style.width);
    }
  });

  // --- Handle file input ---
  document.getElementById('fileInput').addEventListener('change', function() {
    const file = this.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function(e) {
      let text = e.target.result;

      // --- Optional preprocessing example ---
      text = text.replace(/\t/g, '    '); // convert tabs to spaces

      right.textContent = text;
    };
    reader.readAsText(file);
  });
</script>

</body>
</html>
